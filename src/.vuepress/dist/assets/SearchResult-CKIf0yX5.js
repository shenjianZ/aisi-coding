import{u as _,f as ae,g as te,h as J,i as le,P as re,t as se,j as ie,k as D,l as x,m as oe,n as U,p as t,q as ue,R as O,s as ne,v as ce,x as de,C as ve,y as ge,z as he,A as pe,B as ye,D as me,E as fe,F as be,G as T,H as $,I as we,J as E,K as ke}from"./app-DG7AHxuT.js";const je=["/intro.html","/","/bigdata/","/java/","/Middleware/","/other/","/project/","/bigdata/flume/flume-channel.html","/bigdata/flume/flume-guide.html","/bigdata/flume/flume-sink.html","/bigdata/flume/flume-source.html","/bigdata/flume/","/bigdata/hadoop/","/bigdata/hive/","/bigdata/zookeeper/","/frontend/htmlCss/","/frontend/javascript/","/frontend/nodejs/","/frontend/react/","/frontend/typescript/","/frontend/vue/","/frontend/vue/vue-core.html","/frontend/vue/vue-guide.html","/frontend/vue/vue-pinia.html","/frontend/vue/vue-route.html","/java/basic/","/java/JavaWeb/basics.html","/java/JavaWeb/exam.html","/java/JavaWeb/","/java/juc/","/java/jvm/","/java/newFeatures/","/java/nio/","/java/SpringBoot/","/java/SpringCloud/","/java/SpringMVC/","/java/SpringSecurity/","/Middleware/docker/docker.html","/Middleware/docker/","/Middleware/linux/","/Middleware/linux/shell.html","/Middleware/git/git-advanced-usage.html","/Middleware/git/git-guide.html","/Middleware/git/","/Middleware/mysql/mysql.html","/Middleware/mysql/","/Middleware/redis/","/Middleware/redis/redis.html","/Middleware/nginx/nginx.html","/Middleware/nginx/","/other/book/","/other/go/","/other/interview/","/project/project-template/backend.html","/project/project-template/frontend.html","/project/project-template/","/other/book/dbs/","/other/book/dv/","/other/book/it/","/other/book/os/os-guide.html","/other/book/os/","/404.html","/frontend/","/category/","/category/%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/","/category/web/","/category/html/","/category/flume/","/category/sink/","/category/flume%E5%AD%A6%E4%B9%A0/","/category/vue/","/category/javaweb/","/category/web%E5%AD%A6%E4%B9%A0/","/category/docker/","/category/linux/","/category/git/","/category/git%E5%AD%A6%E4%B9%A0/","/category/mysql/","/category/cachedatabase/","/category/webserver/","/category/project/","/category/os/","/tag/","/tag/project.ts/","/tag/flume/","/tag/channel/","/tag/guide/","/tag/sink/","/tag/source/","/tag/vue/","/tag/core/","/tag/pinia/","/tag/router/","/tag/javaweb/","/tag/%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/","/tag/javaweb%E6%95%99%E7%A8%8B/","/tag/docker/","/tag/linux/","/tag/shell/","/tag/git/","/tag/advanced/","/tag/mysql/","/tag/redis/","/tag/nginx/","/tag/go/","/tag/java/","/tag/backend/","/tag/frontend/","/tag/springboot/","/tag/dbs/","/tag/dv/","/tag/os/","/article/","/star/","/timeline/"],He="SEARCH_PRO_QUERY_HISTORY",m=_(He,[]),xe=()=>{const{queryHistoryCount:l}=E,r=l>0;return{enabled:r,queryHistory:m,addQueryHistory:s=>{r&&(m.value=Array.from(new Set([s,...m.value.slice(0,l-1)])))},removeQueryHistory:s=>{m.value=[...m.value.slice(0,s),...m.value.slice(s+1)]}}},B=l=>je[l.id]+("anchor"in l?`#${l.anchor}`:""),Ee="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:I}=E,f=_(Ee,[]),Ae=()=>{const l=I>0;return{enabled:l,resultHistory:f,addResultHistory:r=>{if(l){const s={link:B(r),display:r.display};"header"in r&&(s.header=r.header),f.value=[s,...f.value.slice(0,I-1)]}},removeResultHistory:r=>{f.value=[...f.value.slice(0,r),...f.value.slice(r+1)]}}},Re=l=>{const r=ve(),s=J(),A=ge(),o=D(0),k=x(()=>o.value>0),h=he([]);return pe(()=>{const{search:p,terminate:R}=ye(),b=we(c=>{const w=c.join(" "),{searchFilter:q=g=>g,splitWord:C,suggestionsFilter:F,...y}=r.value;w?(o.value+=1,p(c.join(" "),s.value,y).then(g=>q(g,w,s.value,A.value)).then(g=>{o.value-=1,h.value=g}).catch(g=>{console.warn(g),o.value-=1,o.value||(h.value=[])})):h.value=[]},E.searchDelay-E.suggestDelay);U([l,s],([c])=>b(c),{immediate:!0}),me(()=>{R()})}),{isSearching:k,results:h}};var Ce=ae({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:r}){const s=te(),A=J(),o=le(re),{enabled:k,addQueryHistory:h,queryHistory:p,removeQueryHistory:R}=xe(),{enabled:b,resultHistory:c,addResultHistory:w,removeResultHistory:q}=Ae(),C=k||b,F=se(l,"queries"),{results:y,isSearching:g}=Re(F),i=ie({isQuery:!0,index:0}),d=D(0),v=D(0),L=x(()=>C&&(p.value.length>0||c.value.length>0)),S=x(()=>y.value.length>0),M=x(()=>y.value[d.value]||null),W=()=>{const{isQuery:e,index:a}=i;a===0?(i.isQuery=!e,i.index=e?c.value.length-1:p.value.length-1):i.index=a-1},Y=()=>{const{isQuery:e,index:a}=i;a===(e?p.value.length-1:c.value.length-1)?(i.isQuery=!e,i.index=0):i.index=a+1},z=()=>{d.value=d.value>0?d.value-1:y.value.length-1,v.value=M.value.contents.length-1},V=()=>{d.value=d.value<y.value.length-1?d.value+1:0,v.value=0},G=()=>{v.value<M.value.contents.length-1?v.value+=1:V()},K=()=>{v.value>0?v.value-=1:z()},Q=e=>e.map(a=>ke(a)?a:t(a[0],a[1])),N=e=>{if(e.type==="customField"){const a=fe[e.index]||"$content",[u,H=""]=be(a)?a[A.value].split("$content"):a.split("$content");return e.display.map(n=>t("div",Q([u,...n,H])))}return e.display.map(a=>t("div",Q(a)))},j=()=>{d.value=0,v.value=0,r("updateQuery",""),r("close")},X=()=>k?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},o.value.queryHistory),p.value.map((e,a)=>t("div",{class:["search-pro-result-item",{active:i.isQuery&&i.index===a}],onClick:()=>{r("updateQuery",e)}},[t(T,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:u=>{u.preventDefault(),u.stopPropagation(),R(a)}})]))])):null,Z=()=>b?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},o.value.resultHistory),c.value.map((e,a)=>t(O,{to:e.link,class:["search-pro-result-item",{active:!i.isQuery&&i.index===a}],onClick:()=>{j()}},()=>[t(T,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(u=>Q(u)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:u=>{u.preventDefault(),u.stopPropagation(),q(a)}})]))])):null;return oe("keydown",e=>{if(l.isFocusing){if(S.value){if(e.key==="ArrowUp")K();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const a=M.value.contents[v.value];h(l.queries.join(" ")),w(a),s.push(B(a)),j()}}else if(b){if(e.key==="ArrowUp")W();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:a}=i;i.isQuery?(r("updateQuery",p.value[a]),e.preventDefault()):(s.push(c.value[a].link),j())}}}}),U([d,v],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:l.queries.length?!S.value:!L.value}],id:"search-pro-results"},l.queries.length?g.value?t(ue,{hint:o.value.searching}):S.value?t("ul",{class:"search-pro-result-list"},y.value.map(({title:e,contents:a},u)=>{const H=d.value===u;return t("li",{class:["search-pro-result-list-item",{active:H}]},[t("div",{class:"search-pro-result-title"},e||o.value.defaultTitle),a.map((n,ee)=>{const P=H&&v.value===ee;return t(O,{to:B(n),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{h(l.queries.join(" ")),w(n),j()}},()=>[n.type==="text"?null:t(n.type==="title"?ne:n.type==="heading"?ce:de,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?t("div",{class:"content-header"},n.header):null,t("div",N(n))])])})])})):o.value.emptyResult:C?L.value?[X(),Z()]:o.value.emptyHistory:o.value.emptyResult)}});export{Ce as default};
